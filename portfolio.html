<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portfolio — Annick Bouvattier</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">

  <!-- ✅ un seul css global -->
  <link rel="stylesheet" href="styles.css">
</head>

<body class="portfolio">
  <div class="page">
    <div class="container">
      <header class="top">
        <a class="brand" href="index.html">ANNICK&nbsp;BOUVATTIER</a>
        <nav class="top__nav" aria-label="Navigation principale">
          <a class="nav__link" href="index.html">Accueil</a>
          <a class="nav__link is-active" href="portfolio.html">Portfolio</a>
          <a class="nav__link" href="galeries.html">Galeries</a>
          <a class="nav__link" href="expositions.html">Expositions</a>
          <a class="nav__link" href="informations.html">Informations</a>
          <a class="nav__link" href="apropos.html">À propos</a>
          <a class="nav__link" href="presse.html">Presse</a>
        </nav>
      </header>

      <section class="filters" aria-label="Filtres">
        <div class="field">
          <div class="label">Nom</div>
          <input id="q" type="search" placeholder="Rechercher une œuvre…" />
        </div>

        <div class="field">
          <div class="label">Année</div>
          <select id="year">
            <option value="all">Toutes</option>
          </select>
        </div>

        <div class="field">
          <div class="label">Technique</div>
          <select id="technique">
            <option value="all">Toutes</option>
          </select>
        </div>

        <div class="field">
          <div class="label">Taille</div>
          <select id="size">
            <option value="all">Toutes</option>
          </select>
        </div>

        <div class="field">
          <div class="label">Disponible / Vendue</div>
          <select id="status">
            <option value="all">Toutes</option>
            <option value="disponible">Disponible</option>
            <option value="vendue">Vendue</option>
          </select>
        </div>

        <button class="btn" id="reset" type="button">Réinitialiser</button>
      </section>

      <div class="metaRow">
        <h1 class="title">Portfolio</h1>
        <div class="count" id="count"></div>
      </div>

      <section class="masonry" id="masonry" aria-label="Œuvres"></section>
    </div>
  </div>

  <!-- ✅ Modal lightbox (photo max + texte dessus) -->
 <dialog id="modal">
  <div class="modal">
    <div class="modal__media">
      <img class="modal__img" id="modalImg" alt="">
    </div>

    <div class="modal__info">
      <h2 class="modal__h" id="modalTitle"></h2>
      <p class="modal__meta" id="modalMeta"></p>
    </div>

    <button class="modal__closeBtn" id="modalClose" type="button" aria-label="Fermer">×</button>
  </div>
</dialog>


  <script>
    const artworks = [
  { title:"Black & White And Colors", year:2011, technique:"HST", size:"N/A", status:"disponible", image:"images/BlackWhiteAndColors.jpg" },
];

    const els = {
      q: document.getElementById("q"),
      year: document.getElementById("year"),
      technique: document.getElementById("technique"),
      size: document.getElementById("size"),
      status: document.getElementById("status"),
      reset: document.getElementById("reset"),
      masonry: document.getElementById("masonry"),
      count: document.getElementById("count"),
      modal: document.getElementById("modal"),
      modalImg: document.getElementById("modalImg"),
      modalTitle: document.getElementById("modalTitle"),
      modalMeta: document.getElementById("modalMeta"),
      modalClose: document.getElementById("modalClose"),
    };

    function uniq(arr){ return [...new Set(arr)].sort((a,b)=> (""+a).localeCompare(""+b)); }

    function escapeHtml(s){
      return String(s)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function normSize(s){
      return String(s)
        .toLowerCase()
        .replaceAll("×","x")
        .replace(/\s+/g," ")
        .replace(/\s*x\s*/g," x ")
        .replace(/\s*cm\s*/g," cm")
        .trim();
    }

    function hydrateFilters(){
      const years = uniq(artworks.map(a=>a.year)).sort((a,b)=>b-a);
      const techniques = uniq(artworks.map(a=>a.technique));
      const sizes = uniq(artworks.map(a=>normSize(a.size)));

      years.forEach(y=>{
        const opt = document.createElement("option");
        opt.value = String(y);
        opt.textContent = String(y);
        els.year.appendChild(opt);
      });

      techniques.forEach(t=>{
        const opt = document.createElement("option");
        opt.value = t;
        opt.textContent = t;
        els.technique.appendChild(opt);
      });

      sizes.forEach(s=>{
        const opt = document.createElement("option");
        opt.value = s;
        opt.textContent = s;
        els.size.appendChild(opt);
      });
    }

    function match(a, f){
      const q = (f.q||"").trim().toLowerCase();
      if(q && !a.title.toLowerCase().includes(q)) return false;

      if(f.year !== "all" && String(a.year) !== f.year) return false;
      if(f.technique !== "all" && a.technique !== f.technique) return false;
      if(f.size !== "all" && normSize(a.size) !== f.size) return false;
      if(f.status !== "all" && a.status !== f.status) return false;

      return true;
    }

    function render(){
      const f = {
        q: els.q.value || "",
        year: els.year.value,
        technique: els.technique.value,
        size: els.size.value,
        status: els.status.value
      };

      const list = artworks.filter(a => match(a, f));
      els.masonry.innerHTML = "";

      list.forEach(a=>{
        const item = document.createElement("article");
        item.className = "piece";
        item.innerHTML = `
          <div class="imgWrap">
            <img src="${a.image}" alt="${escapeHtml(a.title)}" loading="lazy">
          </div>
          <div class="cap">
            <p class="capTitle">${escapeHtml(a.title)}</p>
            <p class="capMeta">${escapeHtml(a.technique)} · ${escapeHtml(a.size)} · ${a.year}</p>
            <span class="badge ${a.status}">
              ${a.status === "vendue" ? "VENDUE" : "DISPONIBLE"}
            </span>
          </div>
        `;
        item.addEventListener("click", ()=> openModal(a));
        els.masonry.appendChild(item);
      });

      els.count.textContent = `${list.length} œuvre${list.length>1 ? "s" : ""}`;
    }

    function openModal(a){
      els.modalImg.src = a.image.replace("w=1600","w=2400");
      els.modalImg.alt = a.title;
      els.modalTitle.textContent = a.title.toUpperCase();

      const label = (a.status === "vendue") ? "VENDUE" : "DISPONIBLE";
      els.modalMeta.innerHTML = `${a.technique} · ${a.size} · ${a.year} · <span class="statusText ${a.status}">${label}</span>`;

      els.modal.showModal();
    }
    function closeModal(){ els.modal.close(); }

    ["input","change"].forEach(evt=>{
      els.q.addEventListener(evt, render);
      els.year.addEventListener(evt, render);
      els.technique.addEventListener(evt, render);
      els.size.addEventListener(evt, render);
      els.status.addEventListener(evt, render);
    });

    els.reset.addEventListener("click", ()=>{
      els.q.value = "";
      els.year.value = "all";
      els.technique.value = "all";
      els.size.value = "all";
      els.status.value = "all";
      render();
    });

    els.modalClose.addEventListener("click", closeModal);
    els.modal.addEventListener("click", (e)=>{ if(e.target === els.modal) closeModal(); });
    document.addEventListener("keydown", (e)=>{ if(e.key === "Escape" && els.modal.open) closeModal(); });

    hydrateFilters();
    render();
  </script>
</body>
</html>
